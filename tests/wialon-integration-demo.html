<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–î–µ–º–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Wialon - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: #f3f4f6;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .header h1 {
      color: #1f2937;
      font-size: 24px;
      margin-bottom: 8px;
    }

    .header p {
      color: #6b7280;
      font-size: 14px;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 20px;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .stat-value {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 12px;
      color: #6b7280;
      text-transform: uppercase;
    }

    .moving {
      color: #10b981;
    }

    .stopped {
      color: #f59e0b;
    }

    .offline {
      color: #ef4444;
    }

    .total {
      color: #3b82f6;
    }

    .map-container {
      background: white;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .map-header {
      padding: 16px 20px;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      justify-content: between;
      align-items: center;
    }

    .map-title {
      font-size: 18px;
      font-weight: 600;
      color: #1f2937;
    }

    .map-controls {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .btn {
      padding: 6px 12px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      background: white;
      color: #374151;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn:hover {
      background: #f9fafb;
    }

    .btn.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }

    #map {
      height: 500px;
      width: 100%;
    }

    .status-indicator {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 6px;
    }

    .config-section {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .config-section h2 {
      color: #1f2937;
      font-size: 18px;
      margin-bottom: 12px;
    }

    .config-form {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group label {
      font-size: 12px;
      color: #374151;
      margin-bottom: 4px;
      font-weight: 500;
    }

    .form-group input {
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      font-size: 14px;
    }

    .alert {
      padding: 12px 16px;
      border-radius: 6px;
      margin-bottom: 16px;
      font-size: 14px;
    }

    .alert-info {
      background: #dbeafe;
      color: #1e40af;
      border: 1px solid #93c5fd;
    }

    .alert-warning {
      background: #fef3c7;
      color: #92400e;
      border: 1px solid #fcd34d;
    }

    .code-block {
      background: #f3f4f6;
      padding: 12px;
      border-radius: 4px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 12px;
      color: #374151;
      margin-top: 8px;
      overflow-x: auto;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="header">
      <h1>üöå –î–µ–º–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Wialon - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</h1>
      <p>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –∫–∞—Ä—Ç—ã —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –¥–ª—è –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è STC Transfer</p>
    </div>

    <!-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Wialon -->
    <div class="config-section">
      <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Wialon</h2>

      <div class="alert alert-info">
        <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> –°–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
        –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É Wialon API –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è –Ω–∏–∂–µ.
      </div>

      <div class="config-form">
        <div class="form-group">
          <label>URL —Å–µ—Ä–≤–µ—Ä–∞ Wialon</label>
          <input type="text" id="wialonUrl" placeholder="https://hst-api.wialon.com" />
        </div>
        <div class="form-group">
          <label>–¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞</label>
          <input type="text" id="wialonToken" placeholder="–í–∞—à —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ –∫ Wialon API" />
        </div>
      </div>

      <div class="code-block">
        // –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –∫–æ–¥–µ:
        export const wialonConfig: WialonConfig = {
        baseUrl: 'https://hst-api.wialon.com',
        token: '–í–ê–®_–¢–û–ö–ï–ù_–î–û–°–¢–£–ü–ê'
        };
      </div>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="stats">
      <div class="stat-card">
        <div class="stat-value moving" id="movingCount">2</div>
        <div class="stat-label">–í –¥–≤–∏–∂–µ–Ω–∏–∏</div>
      </div>
      <div class="stat-card">
        <div class="stat-value stopped" id="stoppedCount">1</div>
        <div class="stat-label">–ù–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ</div>
      </div>
      <div class="stat-card">
        <div class="stat-value offline" id="offlineCount">1</div>
        <div class="stat-label">–û—Ñ—Ñ–ª–∞–π–Ω</div>
      </div>
      <div class="stat-card">
        <div class="stat-value total" id="totalCount">4</div>
        <div class="stat-label">–í—Å–µ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞</div>
      </div>
    </div>

    <!-- –ö–∞—Ä—Ç–∞ -->
    <div class="map-container">
      <div class="map-header">
        <div class="map-title">üó∫Ô∏è –ö–∞—Ä—Ç–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞</div>
        <div class="map-controls">
          <span class="status-indicator" style="background: #10b981;"></span>
          <span style="font-size: 12px; color: #6b7280;">–î–µ–º–æ-—Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω</span>
          <button class="btn" onclick="refreshMap()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
          <button class="btn active" onclick="toggleMode()">–î–µ–º–æ</button>
        </div>
      </div>
      <div id="map"></div>
    </div>

    <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
    <div class="config-section">
      <h2>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</h2>

      <div class="alert alert-warning">
        <strong>–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É Wialon:</strong>
      </div>

      <ol style="margin-left: 20px; color: #374151; line-height: 1.6;">
        <li><strong>–¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞:</strong> –ü–æ–ª—É—á–∏—Ç–µ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ Wialon (–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–æ—Å—Ç—É–ø ‚Üí –¢–æ–∫–µ–Ω—ã)</li>
        <li><strong>URL —Å–µ—Ä–≤–µ—Ä–∞:</strong> –û–±—ã—á–Ω–æ https://hst-api.wialon.com –∏–ª–∏ –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞</li>
        <li><strong>–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:</strong> –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–µ</li>
        <li><strong>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS:</strong> –í–æ–∑–º–æ–∂–Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å CORS –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Wialon</li>
      </ol>

      <h3 style="margin: 16px 0 8px 0; color: #1f2937;">–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã:</h3>
      <ul style="margin-left: 20px; color: #374151; line-height: 1.6;">
        <li>‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</li>
        <li>‚úÖ –°—Ç–∞—Ç—É—Å—ã: –≤ –¥–≤–∏–∂–µ–Ω–∏–∏, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –æ—Ñ—Ñ–ª–∞–π–Ω</li>
        <li>‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∫–æ—Ä–æ—Å—Ç–∏, —Ç–æ–ø–ª–∏–≤–µ, –≤–æ–¥–∏—Ç–µ–ª–µ</li>
        <li>‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥</li>
        <li>‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤</li>
        <li>‚úÖ –î–µ–º–æ-—Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
      </ul>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
    const map = L.map('map').setView([41.2995, 69.2401], 11);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap contributors'
    }).addTo(map);

    // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
    const demoVehicles = [
      {
        id: 'demo-1',
        name: '–ê–≤—Ç–æ–±—É—Å ‚Ññ1 (–ê123–ë–í)',
        lat: 41.2995,
        lng: 69.2401,
        speed: 45,
        status: 'moving',
        driver: '–ò–≤–∞–Ω–æ–≤ –ò.–ò.',
        fuel: 75
      },
      {
        id: 'demo-2',
        name: '–ê–≤—Ç–æ–±—É—Å ‚Ññ2 (–í456–ì–î)',
        lat: 41.3111,
        lng: 69.2797,
        speed: 0,
        status: 'stopped',
        driver: '–ü–µ—Ç—Ä–æ–≤ –ü.–ü.',
        fuel: 60
      },
      {
        id: 'demo-3',
        name: '–ê–≤—Ç–æ–±—É—Å ‚Ññ3 (–ì789–ï–ñ)',
        lat: 41.2647,
        lng: 69.2163,
        speed: 30,
        status: 'moving',
        driver: '–°–∏–¥–æ—Ä–æ–≤ –°.–°.',
        fuel: 40
      },
      {
        id: 'demo-4',
        name: '–ê–≤—Ç–æ–±—É—Å ‚Ññ4 (–î012–ó–ò)',
        lat: 41.3258,
        lng: 69.2516,
        speed: 0,
        status: 'offline',
        driver: '–ö–æ–∑–ª–æ–≤ –ö.–ö.',
        fuel: 20
      }
    ];

    let markers = [];

    // –°–æ–∑–¥–∞–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
    function createVehicleIcon(status) {
      const colors = {
        moving: '#10b981',
        stopped: '#f59e0b',
        offline: '#ef4444'
      };

      return L.divIcon({
        html: `<div style="
                    width: 20px; 
                    height: 20px; 
                    background: ${colors[status]}; 
                    border: 2px solid white;
                    border-radius: 50%;
                    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
                "></div>`,
        className: 'custom-vehicle-icon',
        iconSize: [20, 20],
        iconAnchor: [10, 10]
      });
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ
    function displayVehicles() {
      // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –º–∞—Ä–∫–µ—Ä—ã
      markers.forEach(marker => map.removeLayer(marker));
      markers = [];

      // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –º–∞—Ä–∫–µ—Ä—ã
      demoVehicles.forEach(vehicle => {
        const marker = L.marker([vehicle.lat, vehicle.lng], {
          icon: createVehicleIcon(vehicle.status)
        }).addTo(map);

        const statusText = {
          moving: '–í –¥–≤–∏–∂–µ–Ω–∏–∏',
          stopped: '–û—Å—Ç–∞–Ω–æ–≤–∫–∞',
          offline: '–û—Ñ—Ñ–ª–∞–π–Ω'
        };

        marker.bindPopup(`
                    <div style="min-width: 200px;">
                        <h4 style="margin: 0 0 8px 0; color: #1f2937;">${vehicle.name}</h4>
                        <div style="font-size: 12px; color: #6b7280; line-height: 1.4;">
                            <div><strong>–°—Ç–∞—Ç—É—Å:</strong> ${statusText[vehicle.status]}</div>
                            <div><strong>–°–∫–æ—Ä–æ—Å—Ç—å:</strong> ${vehicle.speed} –∫–º/—á</div>
                            <div><strong>–í–æ–¥–∏—Ç–µ–ª—å:</strong> ${vehicle.driver}</div>
                            <div><strong>–¢–æ–ø–ª–∏–≤–æ:</strong> ${vehicle.fuel}%</div>
                        </div>
                    </div>
                `);

        markers.push(marker);
      });

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      updateStats();
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    function updateStats() {
      const stats = {
        moving: demoVehicles.filter(v => v.status === 'moving').length,
        stopped: demoVehicles.filter(v => v.status === 'stopped').length,
        offline: demoVehicles.filter(v => v.status === 'offline').length,
        total: demoVehicles.length
      };

      document.getElementById('movingCount').textContent = stats.moving;
      document.getElementById('stoppedCount').textContent = stats.stopped;
      document.getElementById('offlineCount').textContent = stats.offline;
      document.getElementById('totalCount').textContent = stats.total;
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
    function refreshMap() {
      // –ò–º–∏—Ç–∏—Ä—É–µ–º –Ω–µ–±–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ–∑–∏—Ü–∏—è—Ö
      demoVehicles.forEach(vehicle => {
        if (vehicle.status === 'moving') {
          vehicle.lat += (Math.random() - 0.5) * 0.001;
          vehicle.lng += (Math.random() - 0.5) * 0.001;
          vehicle.speed = Math.floor(Math.random() * 60) + 10;
        }
      });

      displayVehicles();
    }

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
    function toggleMode() {
      alert('–í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–µ–º–æ-—Ä–µ–∂–∏–º–æ–º –∏ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ Wialon');
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    displayVehicles();

    // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    setInterval(refreshMap, 30000);

    console.log('üöå –î–µ–º–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Wialon –∑–∞–≥—Ä—É–∂–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!');
    console.log('üìç –ü–æ–∫–∞–∑–∞–Ω–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤:', demoVehicles.length);
  </script>
</body>

</html>