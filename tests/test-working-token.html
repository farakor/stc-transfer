<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–¢–µ—Å—Ç —Ä–∞–±–æ—á–µ–≥–æ —Ç–æ–∫–µ–Ω–∞ Wialon</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }

    .container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .status {
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      font-weight: 500;
    }

    .status.loading {
      background: #e0f2fe;
      color: #0277bd;
      border: 1px solid #81d4fa;
    }

    .status.success {
      background: #e8f5e8;
      color: #2e7d32;
      border: 1px solid #81c784;
    }

    .status.error {
      background: #ffebee;
      color: #c62828;
      border: 1px solid #ef9a9a;
    }

    .info-block {
      background: #e3f2fd;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      border-left: 4px solid #2196f3;
    }

    .btn {
      background: #007bff;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin: 5px;
      font-weight: 500;
    }

    .btn:hover {
      background: #0056b3;
    }

    .btn:disabled {
      background: #6c757d;
      cursor: not-allowed;
    }

    .btn.success {
      background: #28a745;
    }

    .btn.large {
      padding: 15px 30px;
      font-size: 16px;
    }

    .vehicle-list {
      margin-top: 20px;
      max-height: 400px;
      overflow-y: auto;
    }

    .vehicle-item {
      background: #f8f9fa;
      padding: 12px;
      margin: 8px 0;
      border-radius: 4px;
      border-left: 3px solid #28a745;
    }

    .vehicle-offline {
      border-left-color: #dc3545;
    }

    .vehicle-moving {
      border-left-color: #28a745;
    }

    .vehicle-stopped {
      border-left-color: #ffc107;
    }

    .token-info {
      background: #d4edda;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      border-left: 4px solid #28a745;
    }

    .step {
      background: #f8f9fa;
      padding: 15px;
      margin: 10px 0;
      border-radius: 6px;
      border-left: 3px solid #007bff;
    }

    .step.completed {
      border-left-color: #28a745;
      background: #d4edda;
    }

    .step.error {
      border-left-color: #dc3545;
      background: #f8d7da;
    }

    .coordinates {
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 12px;
      color: #666;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .stat-card {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 6px;
      text-align: center;
      border: 1px solid #dee2e6;
    }

    .stat-number {
      font-size: 24px;
      font-weight: bold;
      color: #007bff;
    }

    .stat-label {
      font-size: 12px;
      color: #666;
      text-transform: uppercase;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>üîë –¢–µ—Å—Ç —Ä–∞–±–æ—á–µ–≥–æ —Ç–æ–∫–µ–Ω–∞ Wialon</h1>
    
    <div class="token-info">
      <strong>‚úÖ –†–∞–±–æ—á–∏–π —Ç–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω!</strong><br>
      <small>–¢–æ–∫–µ–Ω: 85991e5f06896e98fe3c0bd49d2fe6d8EC2B0F5F2A7A963F0EC0B869EB87FF8188C6EE8D</small><br>
      <small>–°–µ—Ä–≤–µ—Ä: http://176.74.220.111/login_simple.html</small>
    </div>

    <div class="info-block">
      <strong>üìã –≠—Ç–∞–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</strong><br>
      1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å —Ç–æ–∫–µ–Ω–æ–º<br>
      2. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ<br>
      3. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞<br>
      4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞<br>
      5. –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    <div style="text-align: center; margin: 20px 0;">
      <button class="btn large success" onclick="runFullTest()">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç</button>
      <button class="btn" onclick="testLogin()">üîê –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</button>
      <button class="btn" onclick="getVehicles()" id="vehiclesBtn" disabled>üöå –ü–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç</button>
      <button class="btn" onclick="updatePositions()" id="positionsBtn" disabled>üìç –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏–∏</button>
      <button class="btn" onclick="clearResults()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
    </div>

    <!-- –≠—Ç–∞–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div id="steps">
      <div class="step" id="step1">
        <strong>–®–∞–≥ 1:</strong> –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å —Ç–æ–∫–µ–Ω–æ–º
        <div id="step1-result"></div>
      </div>
      <div class="step" id="step2">
        <strong>–®–∞–≥ 2:</strong> –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        <div id="step2-result"></div>
      </div>
      <div class="step" id="step3">
        <strong>–®–∞–≥ 3:</strong> –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
        <div id="step3-result"></div>
      </div>
      <div class="step" id="step4">
        <strong>–®–∞–≥ 4:</strong> –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
        <div id="step4-result"></div>
      </div>
      <div class="step" id="step5">
        <strong>–®–∞–≥ 5:</strong> –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
        <div id="step5-result"></div>
      </div>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="stats-grid" id="statsGrid" style="display: none;">
      <div class="stat-card">
        <div class="stat-number" id="totalVehicles">0</div>
        <div class="stat-label">–í—Å–µ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="onlineVehicles">0</div>
        <div class="stat-label">–û–Ω–ª–∞–π–Ω</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="movingVehicles">0</div>
        <div class="stat-label">–í –¥–≤–∏–∂–µ–Ω–∏–∏</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="stoppedVehicles">0</div>
        <div class="stat-label">–û—Å—Ç–∞–Ω–æ–≤–∫–∞</div>
      </div>
    </div>

    <!-- –°—Ç–∞—Ç—É—Å -->
    <div id="status"></div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
    <div id="results"></div>

    <!-- –õ–æ–≥–∏ -->
    <div id="log"></div>
  </div>

  <script>
    const baseUrl = 'https://176.74.220.111';
    const workingToken = '85991e5f06896e98fe3c0bd49d2fe6d825770468546E156C3088DF44EB44163B2A478841';
    let session = null;
    let vehicles = [];

    function log(message, type = 'info') {
      const logDiv = document.getElementById('log');
      const timestamp = new Date().toLocaleTimeString();
      const logEntry = document.createElement('div');
      logEntry.innerHTML = `<strong>[${timestamp}]</strong> ${message}`;
      logEntry.style.margin = '2px 0';
      logEntry.style.padding = '3px';
      logEntry.style.borderRadius = '3px';
      logEntry.style.fontSize = '12px';

      switch (type) {
        case 'error':
          logEntry.style.background = '#ffebee';
          logEntry.style.color = '#c62828';
          break;
        case 'success':
          logEntry.style.background = '#e8f5e8';
          logEntry.style.color = '#2e7d32';
          break;
        default:
          logEntry.style.background = '#f8f9fa';
          logEntry.style.color = '#495057';
      }

      logDiv.appendChild(logEntry);
      logDiv.scrollTop = logDiv.scrollHeight;
    }

    function showStatus(message, type) {
      const statusDiv = document.getElementById('status');
      statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
    }

    function updateStep(stepNumber, status, message = '') {
      const step = document.getElementById(`step${stepNumber}`);
      const result = document.getElementById(`step${stepNumber}-result`);
      
      step.className = `step ${status}`;
      if (message) {
        result.innerHTML = `<small>${message}</small>`;
      }
    }

    // –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    async function testLogin() {
      log('=== –¢–ï–°–¢ –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò ===');
      updateStep(1, 'loading');
      showStatus('üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è...', 'loading');

      try {
        const response = await fetch(`${baseUrl}?svc=token/login`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
          },
          body: `params=${JSON.stringify({ token: workingToken })}`
        });

        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }

        const data = await response.json();
        
        if (data.error) {
          throw new Error(`Wialon Error: ${data.error}`);
        }

        session = {
          sid: data.eid,
          userId: data.user?.id || 0,
          userName: data.user?.nm || 'Unknown'
        };

        updateStep(1, 'completed', `‚úÖ SID: ${session.sid}, –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${session.userName}`);
        log(`‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! SID: ${session.sid}`, 'success');
        showStatus(`‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –∫–∞–∫: ${session.userName}`, 'success');

        document.getElementById('vehiclesBtn').disabled = false;
        return true;

      } catch (error) {
        updateStep(1, 'error', `‚ùå ${error.message}`);
        log(`‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: ${error.message}`, 'error');
        showStatus(`‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: ${error.message}`, 'error');
        return false;
      }
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
    async function getVehicles() {
      if (!session) {
        showStatus('‚ùå –°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é', 'error');
        return false;
      }

      log('=== –ü–û–õ–£–ß–ï–ù–ò–ï –°–ü–ò–°–ö–ê –¢–†–ê–ù–°–ü–û–†–¢–ê ===');
      updateStep(3, 'loading');
      showStatus('üöå –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞...', 'loading');

      try {
        const response = await fetch(`${baseUrl}?svc=core/search_items&sid=${session.sid}`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
          },
          body: `params=${JSON.stringify({
            spec: {
              itemsType: 'avl_unit',
              propName: 'sys_name',
              propValueMask: '*',
              sortType: 'sys_name'
            },
            force: 1,
            flags: 0x1,
            from: 0,
            to: 0
          })}`
        });

        const data = await response.json();
        
        if (data.error) {
          throw new Error(data.error);
        }

        vehicles = data.items || [];
        updateStep(3, 'completed', `‚úÖ –ù–∞–π–¥–µ–Ω–æ: ${vehicles.length} —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤`);
        log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤: ${vehicles.length}`, 'success');

        if (vehicles.length === 0) {
          showStatus('‚ö†Ô∏è –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã', 'error');
          return false;
        }

        document.getElementById('positionsBtn').disabled = false;
        showStatus(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${vehicles.length} —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤`, 'success');
        return true;

      } catch (error) {
        updateStep(3, 'error', `‚ùå ${error.message}`);
        log(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
        showStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
        return false;
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
    async function updatePositions() {
      if (!vehicles.length || !session) {
        showStatus('‚ùå –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞', 'error');
        return false;
      }

      log('=== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–û–ó–ò–¶–ò–ô ===');
      updateStep(4, 'loading');
      showStatus('üìç –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π...', 'loading');

      try {
        const vehicleIds = vehicles.map(v => v.id);
        const response = await fetch(`${baseUrl}?svc=core/update_data_flags&sid=${session.sid}`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
          },
          body: `params=${JSON.stringify({
            spec: vehicleIds.map(id => ({
              type: 'id',
              data: id,
              flags: 0x1 | 0x2
            }))
          })}`
        });

        const data = await response.json();
        
        updateStep(4, 'completed', `‚úÖ –ü–æ–∑–∏—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã`);
        log('‚úÖ –ü–æ–∑–∏—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'success');
        
        analyzeData();
        displayVehicles();
        showStatus('‚úÖ –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã', 'success');
        return true;

      } catch (error) {
        updateStep(4, 'error', `‚ùå ${error.message}`);
        log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π: ${error.message}`, 'error');
        showStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
        return false;
      }
    }

    // –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
    function analyzeData() {
      updateStep(5, 'loading');
      
      let online = 0, moving = 0, stopped = 0;
      const now = Math.floor(Date.now() / 1000);

      vehicles.forEach(vehicle => {
        const pos = vehicle.pos;
        if (pos && (now - pos.t) < 600) { // 10 –º–∏–Ω—É—Ç
          online++;
          const speed = pos.s || 0;
          if (speed > 5) {
            moving++;
          } else {
            stopped++;
          }
        }
      });

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      document.getElementById('totalVehicles').textContent = vehicles.length;
      document.getElementById('onlineVehicles').textContent = online;
      document.getElementById('movingVehicles').textContent = moving;
      document.getElementById('stoppedVehicles').textContent = stopped;
      document.getElementById('statsGrid').style.display = 'grid';

      updateStep(5, 'completed', `‚úÖ –û–Ω–ª–∞–π–Ω: ${online}, –í –¥–≤–∏–∂–µ–Ω–∏–∏: ${moving}, –û—Å—Ç–∞–Ω–æ–≤–∫–∞: ${stopped}`);
      log(`‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: –û–Ω–ª–∞–π–Ω: ${online}, –í –¥–≤–∏–∂–µ–Ω–∏–∏: ${moving}, –û—Å—Ç–∞–Ω–æ–≤–∫–∞: ${stopped}`, 'success');
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
    function displayVehicles() {
      const resultsDiv = document.getElementById('results');
      
      if (!vehicles.length) {
        resultsDiv.innerHTML = '';
        return;
      }

      let html = '<h3>üöå –í–∞—à —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç:</h3><div class="vehicle-list">';
      const now = Math.floor(Date.now() / 1000);

      vehicles.forEach(vehicle => {
        const pos = vehicle.pos;
        const isOnline = pos && (now - pos.t) < 600;
        const speed = pos?.s || 0;
        let status = '–û—Ñ—Ñ–ª–∞–π–Ω';
        let statusClass = 'vehicle-offline';
        
        if (isOnline) {
          if (speed > 5) {
            status = '–í –¥–≤–∏–∂–µ–Ω–∏–∏';
            statusClass = 'vehicle-moving';
          } else {
            status = '–û—Å—Ç–∞–Ω–æ–≤–∫–∞';
            statusClass = 'vehicle-stopped';
          }
        }

        html += `
          <div class="vehicle-item ${statusClass}">
            <strong>${vehicle.nm || `–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç ${vehicle.id}`}</strong><br>
            <small>
              ID: ${vehicle.id} | –°—Ç–∞—Ç—É—Å: ${status} | –°–∫–æ—Ä–æ—Å—Ç—å: ${speed} –∫–º/—á<br>
              ${pos ? `<span class="coordinates">–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${pos.y?.toFixed(6)}, ${pos.x?.toFixed(6)}</span>` : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–∑–∏—Ü–∏–∏'}<br>
              ${pos ? `–û–±–Ω–æ–≤–ª–µ–Ω–æ: ${new Date(pos.t * 1000).toLocaleString()}` : ''}
            </small>
          </div>
        `;
      });

      html += '</div>';
      resultsDiv.innerHTML = html;
    }

    // –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç
    async function runFullTest() {
      log('=== –ó–ê–ü–£–°–ö –ü–û–õ–ù–û–ì–û –¢–ï–°–¢–ê ===');
      
      // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
      for (let i = 1; i <= 5; i++) {
        updateStep(i, '');
      }
      
      // –®–∞–≥ 1: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
      const loginSuccess = await testLogin();
      if (!loginSuccess) return;
      
      await new Promise(resolve => setTimeout(resolve, 1000));
      
      // –®–∞–≥ 2: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (—É–∂–µ –ø–æ–ª—É—á–µ–Ω–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
      updateStep(2, 'completed', `‚úÖ ID: ${session.userId}, –ò–º—è: ${session.userName}`);
      
      await new Promise(resolve => setTimeout(resolve, 1000));
      
      // –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
      const vehiclesSuccess = await getVehicles();
      if (!vehiclesSuccess) return;
      
      await new Promise(resolve => setTimeout(resolve, 1000));
      
      // –®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π
      await updatePositions();
      
      log('=== –ü–û–õ–ù–´–ô –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù ===', 'success');
    }

    // –û—á–∏—Å—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    function clearResults() {
      document.getElementById('results').innerHTML = '';
      document.getElementById('log').innerHTML = '';
      document.getElementById('status').innerHTML = '';
      document.getElementById('statsGrid').style.display = 'none';
      document.getElementById('vehiclesBtn').disabled = true;
      document.getElementById('positionsBtn').disabled = true;
      
      for (let i = 1; i <= 5; i++) {
        updateStep(i, '');
        document.getElementById(`step${i}-result`).innerHTML = '';
      }
      
      session = null;
      vehicles = [];
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    window.onload = function() {
      log('üîë –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—á–µ–≥–æ —Ç–æ–∫–µ–Ω–∞ –≥–æ—Ç–æ–≤–∞!');
      log(`–¢–æ–∫–µ–Ω: ${workingToken.substring(0, 30)}...`);
      log(`–°–µ—Ä–≤–µ—Ä: ${baseUrl}`);
      log('–ù–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç" –¥–ª—è –Ω–∞—á–∞–ª–∞');
    };
  </script>
</body>

</html>
