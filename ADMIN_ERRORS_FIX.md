# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚úÖ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ `/api` –≤ URL

**–ü—Ä–æ–±–ª–µ–º–∞:** URL —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∏—Å—å –∫–∞–∫ `/api/api/bookings/stats` –≤–º–µ—Å—Ç–æ `/api/bookings/stats`

**–§–∞–π–ª:** `frontend/src/services/adminService.ts`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**

- `'/api/bookings/stats'` ‚Üí `'/bookings/stats'`
- `'/api/bookings/${id}/status'` ‚Üí `'/bookings/${id}/status'`
- `'/api/bookings/${id}/assign-driver'` ‚Üí `'/bookings/${id}/assign-driver'`

### 2. ‚úÖ –û—à–∏–±–∫–∞ 500 –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É JWT payload –∏ middleware

**–§–∞–π–ª—ã:**

- `backend/src/controllers/adminAuthController.ts`

**–ß—Ç–æ –±—ã–ª–æ:**

- –í JWT —Ç–æ–∫–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å `userId: admin.id`
- –í middleware –æ–∂–∏–¥–∞–ª–æ—Å—å `adminId`
- –í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å `(req as any).userId`

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**

- JWT —Ç–æ–∫–µ–Ω —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `adminId: admin.id`
- –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `(req as any).admin` (–∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ middleware)
- –í—Å–µ –º–µ—Ç–æ–¥—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `admin.id` –≤–º–µ—Å—Ç–æ `userId`

**–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

- `getProfile()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `req.admin`
- `changePassword()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `req.admin`
- `deleteAdmin()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `req.admin`

### 3. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è `admin` –≤ request
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend

```bash
cd backend
npm run dev
```

### 2. –í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

URL: `http://localhost:3001/admin/login`

**–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**

- Email: `farrukh.oripov@gmail.com` –∏–ª–∏ `admin@stc.uz`
- –ü–∞—Ä–æ–ª—å: `admin123`

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ dashboard

–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ dashboard –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫:

- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –ü—Ä–æ—Ñ–∏–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ 404 –∏–ª–∏ 500

## –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç

‚úÖ –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å  
‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞  
‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤  
‚úÖ –í—Å–µ API endpoints –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞  
‚úÖ –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è  
‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏ (–¥–ª—è SUPER_ADMIN)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ JWT —Ç–æ–∫–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```json
{
  "adminId": 1,
  "email": "admin@stc.uz",
  "role": "SUPER_ADMIN",
  "type": "admin",
  "iat": 1760397438,
  "exp": 1761002238
}
```

## –í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **Middleware `authenticate`** —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `req.admin` —Å –ø–æ–ª—è–º–∏:

   - `id` - ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
   - `email` - Email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
   - `role` - –†–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
   - `firstName` - –ò–º—è
   - `lastName` - –§–∞–º–∏–ª–∏—è

2. **–í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ä–æ—É—Ç—ã** –∏—Å–ø–æ–ª—å–∑—É—é—Ç `req.admin` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

3. **–¢–æ–∫–µ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã 7 –¥–Ω–µ–π** (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `adminAuthController.ts`)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í—Ö–æ–¥

```bash
curl -X POST http://localhost:3001/api/admin/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email": "admin@stc.uz", "password": "admin123"}'
```

### –ü—Ä–æ—Ñ–∏–ª—å

```bash
curl http://localhost:3001/api/admin/auth/profile \
  -H "Authorization: Bearer <–≤–∞—à-—Ç–æ–∫–µ–Ω>"
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤

```bash
curl http://localhost:3001/api/bookings/stats?period=day \
  -H "Authorization: Bearer <–≤–∞—à-—Ç–æ–∫–µ–Ω>"
```

---

**–í—Å–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!** ‚ú® –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.
