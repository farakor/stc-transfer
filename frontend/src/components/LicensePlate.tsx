import React from 'react';

interface LicensePlateProps {
  plateNumber: string;
  size?: 'small' | 'medium' | 'large';
  className?: string;
}

const LicensePlate: React.FC<LicensePlateProps> = ({
  plateNumber,
  size = 'medium',
  className = ''
}) => {
  // Парсим номер: первый блок 2 цифры, второй блок до 6 цифр/букв
  const parseNumber = (number: string) => {
    // Убираем лишние пробелы и приводим к верхнему регистру
    const clean = number.replace(/\s+/g, '').trim().toUpperCase();

    if (clean.length >= 2) {
      const territorial = clean.substring(0, 2); // Первые 2 цифры
      const series = clean.substring(2); // Остальное (до 6 символов)

      return {
        territorial,
        series: series.substring(0, 6) // Ограничиваем до 6 символов
      };
    }

    return {
      territorial: clean.substring(0, 2),
      series: ''
    };
  };

  const { territorial, series } = parseNumber(plateNumber);

  // Размеры для SVG
  const sizeConfig = {
    small: { width: 120, height: 30, fontSize: 16 },
    medium: { width: 160, height: 40, fontSize: 20 },
    large: { width: 200, height: 50, fontSize: 24 }
  };

  const config = sizeConfig[size];

  return (
    <div className={`inline-block ${className}`}>
      <svg
        width={config.width}
        height={config.height}
        viewBox={`0 0 ${config.width} ${config.height}`}
        xmlns="http://www.w3.org/2000/svg"
      >
        {/* Основной фон номера */}
        <rect
          x="2"
          y="2"
          width={config.width - 4}
          height={config.height - 4}
          fill="white"
          stroke="black"
          strokeWidth="2"
          rx="3"
        />

        {/* Вертикальный разделитель между блоками */}
        <line
          x1="35"
          y1="2"
          x2="35"
          y2={config.height - 2}
          stroke="black"
          strokeWidth="2"
        />

        {/* Флаг Узбекистана - верхняя часть группы флаг+UZ */}
        <g transform={`translate(${config.width - 18}, ${config.height / 2 - 10}) scale(0.025)`}>
          <path fill="#82AFFF" d="M473.655,88.276H38.345C17.167,88.276,0,105.443,0,126.621v63.539h512v-63.539C512,105.443,494.833,88.276,473.655,88.276z" />
          <path fill="#73AF00" d="M0,385.379c0,21.177,17.167,38.345,38.345,38.345h435.31c21.177,0,38.345-17.167,38.345-38.345V321.84H0V385.379z" />
          <rect y="204.1" fill="#F5F5F5" width="512" height="103.79" />
          <polygon fill="#FF4B55" points="0,200.092 0,204.102 512,204.102 512,200.092 512,190.159 0,190.159" />
          <polygon fill="#FF4B55" points="0,311.908 0,321.841 512,321.841 512,311.908 512,307.898 0,307.898" />
          <path fill="#F5F5F5" d="M113.491,172.071c-18.072,0-32.721-14.614-32.721-32.621c0-18.073,14.648-32.753,32.721-32.753c0.07,0,0.138,0,0.206,0.001c1.064,0.014,1.437-1.399,0.499-1.902c-5.565-2.983-11.916-4.671-18.668-4.622c-21.624,0.154-39.189,18.073-38.959,39.697c0.226,21.401,17.722,38.724,39.242,38.724c6.659,0,12.921-1.685,18.417-4.627c0.935-0.501,0.557-1.914-0.503-1.899C113.645,172.071,113.568,172.071,113.491,172.071z" />
          <path fill="#F5F5F5" d="M139.113,163.05l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.716,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.715-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C140.105,162.483,139.303,162.483,139.113,163.05z" />
          <path fill="#F5F5F5" d="M171.656,163.05l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.715,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.715-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C172.647,162.483,171.844,162.483,171.656,163.05z" />
          <path fill="#F5F5F5" d="M204.198,163.05l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.716,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.715-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C205.19,162.483,204.387,162.483,204.198,163.05z" />
          <path fill="#F5F5F5" d="M236.74,163.05l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.715,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.715-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C237.732,162.483,236.929,162.483,236.74,163.05z" />
          <path fill="#F5F5F5" d="M269.283,163.05l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.716,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.716-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C270.274,162.483,269.472,162.483,269.283,163.05z" />
          <path fill="#F5F5F5" d="M171.656,132.678l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.715,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.715-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C172.647,132.109,171.844,132.109,171.656,132.678z" />
          <path fill="#F5F5F5" d="M204.198,132.678l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.716,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.715-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C205.19,132.109,204.387,132.109,204.198,132.678z" />
          <path fill="#F5F5F5" d="M236.74,132.678l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.715,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.715-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C237.732,132.109,236.929,132.109,236.74,132.678z" />
          <path fill="#F5F5F5" d="M269.283,132.678l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.716,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.716-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C270.274,132.109,269.472,132.109,269.283,132.678z" />
          <path fill="#F5F5F5" d="M204.198,102.304l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.716,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.715-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C205.19,101.737,204.387,101.737,204.198,102.304z" />
          <path fill="#F5F5F5" d="M236.74,102.304l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.715,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694L237.33,113l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.715-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C237.732,101.737,236.929,101.737,236.74,102.304z" />
          <path fill="#F5F5F5" d="M269.283,102.304l-1.461,4.382l-4.619,0.035c-0.598,0.004-0.846,0.768-0.365,1.123l3.716,2.744l-1.394,4.404c-0.18,0.57,0.469,1.042,0.956,0.694l3.758-2.686l3.758,2.686c0.487,0.348,1.135-0.124,0.956-0.694l-1.394-4.404l3.716-2.744c0.481-0.355,0.233-1.119-0.365-1.123l-4.619-0.035l-1.461-4.382C270.274,101.737,269.472,101.737,269.283,102.304z" />
        </g>

        {/* Текст территориального кода */}
        <text
          x="18.5"
          y={config.height / 2 + config.fontSize / 3}
          textAnchor="middle"
          fontSize={config.fontSize}
          fontFamily="Courier New, monospace"
          fontWeight="bold"
          fill="black"
        >
          {territorial}
        </text>

        {/* Текст серии и номера */}
        <text
          x={(35 + config.width - 20) / 2}
          y={config.height / 2 + config.fontSize / 3}
          textAnchor="middle"
          fontSize={config.fontSize}
          fontFamily="Courier New, monospace"
          fontWeight="bold"
          fill="black"
        >
          {series}
        </text>

        {/* UZ - нижняя часть группы флаг+UZ */}
        <text
          x={config.width - 12}
          y={config.height / 2 + 8}
          textAnchor="middle"
          fontSize={config.fontSize * 0.5}
          fontFamily="Arial, sans-serif"
          fontWeight="bold"
          fill="#0066CC"
        >
          UZ
        </text>
      </svg>
    </div>
  );
};

export default LicensePlate;
