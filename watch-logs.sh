#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –±–æ—Ç–∞

echo "üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –±–æ—Ç–∞"
echo "======================================"
echo ""
echo "–¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /start –≤ @transfer_srs_driver_bot"
echo ""
echo "–õ–æ–≥–∏ backend:"
echo "-------------"

# –ù–∞—Ö–æ–¥–∏–º –ø—Ä–æ—Ü–µ—Å—Å backend –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ –ª–æ–≥–∏
BACKEND_PID=$(lsof -ti :3001)

if [ -z "$BACKEND_PID" ]; then
    echo "‚ùå Backend –Ω–µ –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3001"
    exit 1
fi

echo "‚úÖ Backend –∑–∞–ø—É—â–µ–Ω (PID: $BACKEND_PID)"
echo ""
echo "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ webhook –∑–∞–ø—Ä–æ—Å–æ–≤..."
echo ""

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–º –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
# –ò—Å–ø–æ–ª—å–∑—É–µ–º tail –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ nodemon
tail -f /dev/null 2>/dev/null &

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
echo "üí° –ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ª–æ–≥–∏:"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –≥–¥–µ –∑–∞–ø—É—â–µ–Ω 'npm run dev'"
echo "2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: ps aux | grep 'node.*backend'"
echo ""
echo "üîç –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ backend –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:"
echo "   cd backend && npm run dev"

